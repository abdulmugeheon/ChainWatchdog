Improve user authentication for refactor (advanced)
